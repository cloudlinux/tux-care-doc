(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{300:function(t,s,e){"use strict";e.r(s);var a=e(14),r=Object(a.a)({},function(){var t=this,s=t.$createElement,e=t._self._c||s;return e("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[e("h1",{attrs:{id:"eportal-api"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#eportal-api"}},[t._v("#")]),t._v(" ePortal API")]),t._v(" "),e("p",[t._v("You may need to create a separate ePortal account for API usage with:")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("kc.eportal user -a api-user -p <password>\n")])])]),e("p",[t._v("It can be useful for SSO/LDAP setups to be able to pass HTTP API credentials via\nbasic auth.")]),t._v(" "),e("p",[t._v("In general ePortal API is configuration management friendly and idempotent. You\ndon't need to make additional request to check existing state. For example\nentity deletion doesn't raise an error in case there is no such entity.\nOr entity creation/modification is a single request that just works and\nsimply brings desired final state.")]),t._v(" "),e("h2",{attrs:{id:"list-servers"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#list-servers"}},[t._v("#")]),t._v(" List servers")]),t._v(" "),e("p",[e("strong",[t._v("GET /admin/api/servers")])]),t._v(" "),e("p",[t._v("Filters servers on various criteria, iterate through list and get\nserver counts.")]),t._v(" "),e("p",[t._v("Requires basic authorization with read only user permissions.")]),t._v(" "),e("p",[e("strong",[t._v("Query string parameters:")])]),t._v(" "),e("ul",[e("li",[e("code",[t._v("hostname")]),t._v(": String, optional. Return servers with a hostname like value. Value can\ncontain "),e("code",[t._v("%")]),t._v(" placeholder to match any string.")]),t._v(" "),e("li",[e("code",[t._v("ip")]),t._v(": String, optional. Return servers with IP like value. Value can\ncontain "),e("code",[t._v("%")]),t._v(" placeholder to match any string.")]),t._v(" "),e("li",[e("code",[t._v("feed")]),t._v(": String, optional. Return servers attached to feed. Use "),e("code",[t._v("main")]),t._v("\nfor default feed.")]),t._v(" "),e("li",[e("code",[t._v("key")]),t._v(": String, optional. Return servers registered to key.")]),t._v(" "),e("li",[e("code",[t._v("registered_age")]),t._v(": Integer, optional. Return servers registered more than\n"),e("code",[t._v("registered_age")]),t._v(" days ago. If "),e("code",[t._v("registered_age")]),t._v(" is negative then return\nservers registered less or equal -"),e("code",[t._v("registered_age")]),t._v(" days ago. For example:\n"),e("code",[t._v("registered_age=-3")]),t._v(" means to return servers registered 3 or less days ago.\nHours can be specified by adding "),e("code",[t._v("h")]),t._v(" suffix: "),e("code",[t._v("registered_age=4h")]),t._v(" selects\nservers registered more than 4 hours ago.")]),t._v(" "),e("li",[e("code",[t._v("checkin_age")]),t._v(": Integer, optional. Return servers sent check-in more than\n"),e("code",[t._v("checkin_age")]),t._v(" days ago. For negative values see "),e("code",[t._v("registered_age")]),t._v(".")]),t._v(" "),e("li",[e("code",[t._v("updated_age")]),t._v(": Integer, optional. Return servers loaded patches more than\n"),e("code",[t._v("updated_age")]),t._v(" days ago. For negative values see "),e("code",[t._v("registered_age")]),t._v(".")]),t._v(" "),e("li",[e("code",[t._v("is_updated")]),t._v(": Boolean, optional. If "),e("code",[t._v("true")]),t._v(" then return servers updated to latest\navailable patches. If "),e("code",[t._v("false")]),t._v(" return servers without latest patches.")]),t._v(" "),e("li",[e("code",[t._v("limit")]),t._v(": Integer, optional. Limit result to a specified number of entries. By\ndefault "),e("code",[t._v("limit")]),t._v(" is 10.")]),t._v(" "),e("li",[e("code",[t._v("offset")]),t._v(": Integer, optional. Set result to a specified offset. "),e("code",[t._v("limit")]),t._v(" and\n"),e("code",[t._v("offset")]),t._v(" can be used to iterate through result.")]),t._v(" "),e("li",[e("code",[t._v("only_count")]),t._v(": Boolean, optional. Return server count only.")]),t._v(" "),e("li",[e("code",[t._v("tag")]),t._v(": String, optional. Adds filter by server tag. E.g "),e("code",[t._v("tag=env:test")]),t._v(" or "),e("code",[t._v("tag=ubuntu")]),t._v(".")])]),t._v(" "),e("p",[e("strong",[t._v("Response:")])]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"count"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("42")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"limit"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("10")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"offset"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"result"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"id"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"99c97tz44uKX13b5"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"ip"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"10.51.16.72"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"hostname"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"localhost.localdomain"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"key"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"some-key"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"feed"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"main"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"registered"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2021-04-08 16:43:23.907671"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"checkin"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2021-07-12 17:35:56.065077"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"updated"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2021-06-01 16:37:03.000000"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"euname"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"3.10.0-1160.25.1.el7"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("        "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// effective kernel version")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"release"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"3.10.0-957.5.1.el7.x86_64"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// installed kernel version")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"kernel_id"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"9647204d2708cad906a75944ee56ac68fc5b5704"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"patch_level"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("49")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"patch_type"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"default"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"tags"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token null keyword"}},[t._v("null")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"uptime"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("6394092")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"version"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"#1 SMP Fri Feb 1 14:54:57 UTC 2019"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"virt"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"kvm"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"kcare_version"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"2.44-2"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"distro"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"CentOS Linux"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"distro_version"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"7.6.1810"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"machine"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"x86_64"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n            "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"processor"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"x86_64"')]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n        ...\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("h2",{attrs:{id:"register-host"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#register-host"}},[t._v("#")]),t._v(" Register host")]),t._v(" "),e("p",[e("strong",[t._v("POST /admin/api/register")])]),t._v(" "),e("p",[t._v("Registers host by provided key and hostname.")]),t._v(" "),e("p",[e("strong",[t._v("Form (urlencoded) parameters:")])]),t._v(" "),e("ul",[e("li",[e("code",[t._v("key")]),t._v(": String, required. ePortal key to use for registration.")]),t._v(" "),e("li",[e("code",[t._v("hostname")]),t._v(": String, optional. Server's hostname to use.")])]),t._v(" "),e("p",[e("strong",[t._v("Success response (200):")])]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"server_id"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"some-server-id"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[e("strong",[t._v("Error response (400):")])]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"error"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"error code"')]),t._v(" # invalid-key | key-limit-reached\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[e("strong",[t._v("Example:")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v('curl -X POST https://eportal.corp.com/admin/api/register -F key=test\n{"server_id":"lw1MO1Du5sF3Cj39"}\n')])])]),e("h2",{attrs:{id:"unregister-host"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#unregister-host"}},[t._v("#")]),t._v(" Unregister host")]),t._v(" "),e("p",[e("strong",[t._v("POST /admin/api/delete_server")])]),t._v(" "),e("p",[t._v("Removes registered servers by IP or hostname")]),t._v(" "),e("p",[t._v("Requires basic authorization with admin user permissions.")]),t._v(" "),e("p",[e("strong",[t._v("Query string parameters:")])]),t._v(" "),e("ul",[e("li",[e("code",[t._v("hostname")]),t._v(": String, optional. Server's hostname to delete.")]),t._v(" "),e("li",[e("code",[t._v("ip")]),t._v(": String, optional. Server's IP to delete.")])]),t._v(" "),e("p",[t._v("Endpoint requires at least one parameter "),e("code",[t._v("hostname")]),t._v(" or "),e("code",[t._v("ip")]),t._v(".")]),t._v(" "),e("p",[e("strong",[t._v("Response:")])]),t._v(" "),e("p",[t._v("Response contains number of deleted servers.")]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"result"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[t._v("For example:")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("curl --user admin:admin-password -X POST https://eportal.corp.com/admin/api/delete_server?ip=192.168.1.1\n")])])]),e("p",[t._v("Below are examples of using "),e("code",[t._v("/admin/api/delete_server")]),t._v(" endpoint with various\nCM products. Take note, you need a host IP or a hostname to delete it via API.\nIt can be more convenient to use on of:")]),t._v(" "),e("ul",[e("li",[t._v("if you have an access to a host (it is alive) it's a way more simpler to call "),e("code",[t._v("kcarectl --unregister")]),t._v(" to delete the host.")]),t._v(" "),e("li",[t._v("if host is already destroyed you can consider using bulk "),e("a",{attrs:{href:"#clean-inactive-servers"}},[t._v("inactive server cleanup")]),t._v(".")])]),t._v(" "),e("h2",{attrs:{id:"create-modify-feed"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#create-modify-feed"}},[t._v("#")]),t._v(" Create/modify feed")]),t._v(" "),e("p",[e("strong",[t._v("POST /admin/api/feeds/")])]),t._v(" "),e("p",[t._v("If feed already exists request modifies it.")]),t._v(" "),e("p",[t._v("Requires write permissions and accepts basic authorization.")]),t._v(" "),e("p",[e("strong",[t._v("Query string/Form/JSON parameters:")])]),t._v(" "),e("ul",[e("li",[e("code",[t._v("name")]),t._v(": String, required. Name of created or modified feed.")]),t._v(" "),e("li",[e("code",[t._v("auto")]),t._v(": Boolean, optional. Sets auto-update property. Default is false.")]),t._v(" "),e("li",[e("code",[t._v("deploy_after")]),t._v(": Integer, optional. Sets delayed period in hours. Default is 0 (not delayed).")])]),t._v(" "),e("p",[e("strong",[t._v("Response:")])]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"result"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test-feed"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"auto"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("true")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"deploy_after"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[e("strong",[t._v("Example:")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("curl -X POST -u admin -d name=test-feed -d auto=true https://eportal.corp.com/admin/api/feeds/\n")])])]),e("h2",{attrs:{id:"list-feeds"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#list-feeds"}},[t._v("#")]),t._v(" List feeds")]),t._v(" "),e("p",[e("strong",[t._v("GET /admin/api/feeds/")])]),t._v(" "),e("p",[t._v("Returns list of existing feeds. Take note: "),e("code",[t._v("main")]),t._v(" feed is alway present\nand couldn't be modified.")]),t._v(" "),e("p",[t._v("Requires read permissions and accepts basic authorization.")]),t._v(" "),e("p",[e("strong",[t._v("Response:")])]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"result"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"auto"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"deploy_after"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"name"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"feed-name"')]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    ...\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[e("strong",[t._v("Example:")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("curl -u admin https://eportal.corp.com/admin/api/feeds/\n")])])]),e("h2",{attrs:{id:"delete-feed"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#delete-feed"}},[t._v("#")]),t._v(" Delete feed")]),t._v(" "),e("p",[e("strong",[t._v("DELETE /admin/api/feeds/:feed-name")])]),t._v(" "),e("p",[t._v("Requires write permissions and accepts basic authorization.")]),t._v(" "),e("p",[e("strong",[t._v("Response:")])]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"result"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// number of deleted records, 0 if there is no such feed.")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[e("strong",[t._v("Example:")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("curl -X DELETE -u admin https://eportal.corp.com/admin/api/feeds/test-feed\n")])])]),e("h2",{attrs:{id:"create-modify-registration-key"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#create-modify-registration-key"}},[t._v("#")]),t._v(" Create/modify registration key")]),t._v(" "),e("p",[e("strong",[t._v("POST /admin/api/keys/")])]),t._v(" "),e("p",[t._v("If key already exists request modifies it.")]),t._v(" "),e("p",[t._v("Requires write permissions and accepts basic authorization.")]),t._v(" "),e("p",[e("strong",[t._v("Query string/Form/JSON parameters:")])]),t._v(" "),e("ul",[e("li",[e("code",[t._v("key")]),t._v(": String, optional. Name of created or modified key. If it's empty\nrandom key is generated.")]),t._v(" "),e("li",[e("code",[t._v("feed")]),t._v(": String, optional. Name of attached feed. "),e("code",[t._v("main")]),t._v(" by default.")]),t._v(" "),e("li",[e("code",[t._v("note")]),t._v(": String, optional. Description of the key.")]),t._v(" "),e("li",[e("code",[t._v("server_limit")]),t._v(": Integer, optional. Advisory limit of a maximum number of hosts\none can register on the key.")])]),t._v(" "),e("p",[e("strong",[t._v("Response:")])]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"result"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"key"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"key"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"feed"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"feed-name"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"note"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"some-note"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"server_limit"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[e("strong",[t._v("Example:")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("curl -X POST -u admin -d key=test-key -d feed=test-feed https://eportal.corp.com/admin/api/keys/\n")])])]),e("h2",{attrs:{id:"list-keys"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#list-keys"}},[t._v("#")]),t._v(" List keys")]),t._v(" "),e("p",[e("strong",[t._v("GET /admin/api/keys/")])]),t._v(" "),e("p",[t._v("Returns list of existing keys.")]),t._v(" "),e("p",[t._v("Requires read permissions and accepts basic authorization.")]),t._v(" "),e("p",[e("strong",[t._v("Response:")])]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"result"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"key"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"feed"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"main"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"note"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token null keyword"}},[t._v("null")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"server_limit"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    ...\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[e("strong",[t._v("Example:")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("curl -u admin https://eportal.corp.com/admin/api/keys/\n")])])]),e("h2",{attrs:{id:"delete-key"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#delete-key"}},[t._v("#")]),t._v(" Delete key")]),t._v(" "),e("p",[e("strong",[t._v("DELETE /admin/api/keys/:key")])]),t._v(" "),e("p",[t._v("Requires write permissions and accepts basic authorization.")]),t._v(" "),e("p",[e("strong",[t._v("Response:")])]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"result"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("  "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// number of deleted records, 0 if there is no such key.")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[e("strong",[t._v("Example:")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("curl -X DELETE -u admin https://eportal.corp.com/admin/api/keys/test-key\n")])])]),e("h2",{attrs:{id:"list-patchsets"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#list-patchsets"}},[t._v("#")]),t._v(" List patchsets")]),t._v(" "),e("p",[e("strong",[t._v("GET /admin/api/patchsets/")])]),t._v(" "),e("p",[t._v("Endpoint lists available patchsets for a feed and product.\nSort order is from oldest to newest patchsets.")]),t._v(" "),e("p",[t._v("Requires read permissions and accepts basic authorization.")]),t._v(" "),e("p",[e("strong",[t._v("Query string parameters:")])]),t._v(" "),e("ul",[e("li",[e("code",[t._v("feed")]),t._v(": String, optional. Name of the feed to list patchsets for. "),e("code",[t._v("main")]),t._v(" by default.")]),t._v(" "),e("li",[e("code",[t._v("product")]),t._v(": String, optional. Possible values are: "),e("code",[t._v("kernel")]),t._v(", "),e("code",[t._v("user")]),t._v(", "),e("code",[t._v("qemu")]),t._v(", "),e("code",[t._v("db")]),t._v(".\nSelects a patchstore for a specified product. "),e("code",[t._v("kernel")]),t._v(" by default.")])]),t._v(" "),e("p",[e("strong",[t._v("Response:")])]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"result"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"patchset"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"patchset-name"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"status"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"enabled"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// possible values are: enabled, disabled, not-downloaded, undeployed")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    ...\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[e("strong",[t._v("Example:")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("curl -u admin 'https://eportal.corp.com/admin/api/patchsets/?feed=main&product=kernel'\n")])])]),e("h2",{attrs:{id:"manage-patchsets"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#manage-patchsets"}},[t._v("#")]),t._v(" Manage patchsets")]),t._v(" "),e("p",[e("strong",[t._v("POST /admin/api/patchsets/manage")])]),t._v(" "),e("p",[t._v("Allows to perform deploy actions on the patchsets.")]),t._v(" "),e("p",[t._v("Requires write permissions and accepts basic authorization.")]),t._v(" "),e("p",[e("strong",[t._v("Query string parameters:")])]),t._v(" "),e("ul",[e("li",[e("code",[t._v("patchset")]),t._v(": String, required. Name of the patchset to operate on.")]),t._v(" "),e("li",[e("code",[t._v("feed")]),t._v(": String, required. Name of the feed to operate on. Can be specified\nmultiple times.")]),t._v(" "),e("li",[e("code",[t._v("action")]),t._v(": String, requred. Operartion to perform:\n"),e("ul",[e("li",[e("code",[t._v("enable")]),t._v(": enable specified patchset.")]),t._v(" "),e("li",[e("code",[t._v("disable")]),t._v(": disable specified patchset.")]),t._v(" "),e("li",[e("code",[t._v("enable-upto")]),t._v(": enable all patchset up to (older than) specified.")]),t._v(" "),e("li",[e("code",[t._v("undeploy-downto")]),t._v(": undeploy all patchsets down to (newer than) specified.")])])]),t._v(" "),e("li",[e("code",[t._v("product")]),t._v(": String, optional. Possible values are: "),e("code",[t._v("kernel")]),t._v(", "),e("code",[t._v("user")]),t._v(", "),e("code",[t._v("qemu")]),t._v(", "),e("code",[t._v("db")]),t._v(".\nSelects a patchstore for a specified product. "),e("code",[t._v("kernel")]),t._v(" by default.")])]),t._v(" "),e("p",[e("strong",[t._v("Response:")])]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"result"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ok"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[e("strong",[t._v("Example:")])]),t._v(" "),e("p",[t._v("Enable libcare patchset "),e("code",[t._v("U20200506_01")]),t._v(" in "),e("code",[t._v("main")]),t._v(" and "),e("code",[t._v("test-feed")]),t._v(" feeds:")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("curl -X POST -u admin 'https://eportal.corp.com/admin/api/patchsets/manage?patchset=U20200506_01&feed=main&feed=test-feed&product=user&action=enable'\n")])])]),e("h2",{attrs:{id:"list-users"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#list-users"}},[t._v("#")]),t._v(" List users")]),t._v(" "),e("p",[e("strong",[t._v("GET /admin/api/users/")])]),t._v(" "),e("p",[t._v("Returns list of existing users.")]),t._v(" "),e("p",[t._v("Requires read permissions and accepts basic authorization.")]),t._v(" "),e("p",[e("strong",[t._v("Response:")])]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"result"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"id"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"username"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"description"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"test user"')]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"readonly"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token boolean"}},[t._v("false")]),t._v("\n    "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    ...\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[e("strong",[t._v("Example:")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("curl -u admin https://eportal.corp.com/admin/api/users/\n")])])]),e("h2",{attrs:{id:"set-tags"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#set-tags"}},[t._v("#")]),t._v(" Set tags")]),t._v(" "),e("p",[e("strong",[t._v("POST /admin/api/set_tags")])]),t._v(" "),e("p",[t._v("Allows assign tags to server")]),t._v(" "),e("p",[t._v("Requires write permissions and accepts basic authorization.")]),t._v(" "),e("p",[e("strong",[t._v("Query string parameters:")])]),t._v(" "),e("ul",[e("li",[e("code",[t._v("server_id")]),t._v(": String, required. ID of the server to attach tags.")]),t._v(" "),e("li",[e("code",[t._v("tags")]),t._v(": String, optional. String with semicolon divided tags. If the parameter is not presented, all tags will be removed")])]),t._v(" "),e("p",[t._v("These parameters can also be provided in the JSON body with the header "),e("code",[t._v("Content-Type: application/json")])]),t._v(" "),e("p",[e("strong",[t._v("Response:")])]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token property"}},[t._v('"result"')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ok"')]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])]),e("p",[e("strong",[t._v("Example:")])]),t._v(" "),e("p",[t._v("Assign tags "),e("code",[t._v("test")]),t._v(" and "),e("code",[t._v("stage")]),t._v(" to server with id "),e("code",[t._v("test-centos")])]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("curl -X POST -u admin 'https://eportal.corp.com/admin/api/set_tags?server_id=test-centos&tags=test;stage'\n")])])]),e("h2",{attrs:{id:"configuration-manager-integration"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#configuration-manager-integration"}},[t._v("#")]),t._v(" Configuration manager integration")]),t._v(" "),e("h3",{attrs:{id:"ansible-playbook"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#ansible-playbook"}},[t._v("#")]),t._v(" Ansible playbook")]),t._v(" "),e("p",[t._v("Integrating ePortal API access with Ansible is now possible. Rather than calling the kernelcare agent to perform tasks, it is possible to replace it with direct calls to ePortal to achieve the same results.")]),t._v(" "),e("p",[t._v("Unregister KernelCare agent through API playbook:")]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[t._v("- hosts"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" kernelcare\n  vars"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n    eportal_srv"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" http"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//eportal.address.here[:port if needed]")]),t._v("\n\n  tasks"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n    - name"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" unregister kernelcare agent through API\n      uri"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n        url"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{{ eportal_srv }}/admin/api/delete_server?ip={{ ansible_default_ipv4.address|default(ansible_all_ipv4_addresses[0]) }}"')]),t._v("\n        method"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" POST\n        user"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" your-api-user\n        password"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" your-api-user-password\n        force_basic_auth"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" yes\n")])])]),e("p",[t._v("Example:")]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[t._v("- hosts"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" kernelcare\n  vars"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n    eportal_srv"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" http"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//192.168.246.110")]),t._v("\n\n  tasks"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n    - name"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" unregister kernelcare agent through API\n      uri"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("\n        url"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"{{ eportal_srv }}/admin/api/delete_server?ip={{ ansible_default_ipv4.address|default(ansible_all_ipv4_addresses[0]) }}"')]),t._v("\n        method"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" POST\n        user"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" api-user\n        password"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" dummy\n        force_basic_auth"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" yes\n")])])]),e("p",[t._v("Ad hoc run with:")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("ansible-playbook -u ansible  ./kernelcare.yml\n")])])]),e("p",[t._v("This can be called during machine tear down to properly remove the server from ePortal.")]),t._v(" "),e("h3",{attrs:{id:"chef-recipe"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#chef-recipe"}},[t._v("#")]),t._v(" Chef recipe")]),t._v(" "),e("p",[t._v("Having tighter integration with automation tools like Chef has always been a goal for KernelCare and related tools like ePortal. The following recipe demonstrates how to use the delete_server api to correctly remove a server from ePortal during tear down, and can be integrated with your other recipes to avoid manual operations.")]),t._v(" "),e("p",[t._v("Unregister KernelCare agent through API recipe:")]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[t._v("eportal_url = "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"EPORTAL URL"')]),t._v("\neportal_user = "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"EPORTAL API USER NAME"')]),t._v("\neportal_password = "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"EPORTAL API USER PASSWORD"')]),t._v("\n\n# the ip to unregister can be pulled automatically from the system where the recipe is applied"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" or specified manually (by replacing the following line with a simple assignment)\nip_to_unregister = "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"#{node['network']['interfaces'][node['network']['default_interface']]['addresses'].select{|k,v| v['family'] == \"")]),t._v("inet"),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"}.keys.first}"')]),t._v("\n\n\nhttp_request "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"kernelcare-unregister-api"')]),t._v(" do\n  url "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"#{eportal_url}/admin/api/delete_server?ip=#{ip_to_unregister}"')]),t._v("\n  action "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("post\n  headers("),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("'AUTHORIZATION' => \"Basic #"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    Base64.encode64("),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"#{eportal_user}:#{eportal_password}"')]),t._v(")"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v('"'),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(")\nend\n")])])]),e("p",[t._v("Example (kernelcare-unregister-api.rb):")]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[t._v("eportal_url = "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"http://192.168.246.110"')]),t._v("\neportal_user = "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"api-user"')]),t._v("\neportal_password = "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"dummy"')]),t._v("\n\nip_to_unregister = "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("\"#{node['network']['interfaces'][node['network']['default_interface']]['addresses'].select{|k,v| v['family'] == \"")]),t._v("inet"),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"}.keys.first}"')]),t._v("\n\nhttp_request "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"kernelcare-unregister-api"')]),t._v(" do\n  url "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"#{eportal_url}/admin/api/delete_server?ip=#{ip_to_unregister}"')]),t._v("\n  action "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("post\n  headers("),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("'AUTHORIZATION' => \"Basic #"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    Base64.encode64("),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"#{eportal_user}:#{eportal_password}"')]),t._v(")"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v('"'),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(")\nend\n")])])]),e("p",[t._v("Ad hoc run with:")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("chef-apply kernelcare-unregister-api.rb\n")])])]),e("p",[t._v("Output:")]),t._v(" "),e("div",{staticClass:"language-json extra-class"},[e("pre",{pre:!0,attrs:{class:"language-json"}},[e("code",[t._v("Recipe"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" (chef-apply cookbook)"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v("(chef-apply recipe)\n  * http_request"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("kernelcare-unregister-api"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" action post\n    - http_request"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("kernelcare-unregister-api"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" POST to http"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//192.168.246.110/admin/api/delete_server?ip=192.168.246.40")]),t._v("\n")])])]),e("p",[t._v("This can be called during machine tear down to properly remove the server from ePortal.")]),t._v(" "),e("h3",{attrs:{id:"puppet-task"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#puppet-task"}},[t._v("#")]),t._v(" Puppet task")]),t._v(" "),e("p",[t._v("Puppet provides the framework to run tasks on target systems. The following is a bash script that can run as such a task and demonstrates how to use the delete_server api to correctly remove a server from ePortal during tear down. It can be integrated with your other removal scripts or tasks to avoid manual operations.")]),t._v(" "),e("p",[t._v("Unregister KernelCare agent through API call:")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token shebang important"}},[t._v("#!/bin/bash")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("EPORTAL_API_USERNAME")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("your ePortal api user name"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("EPORTAL_API_PASSWORD")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("your ePortal api user password"),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("EPORTAL_URL")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'your ePortal URL'")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#this is taken from the primary ip in the system. If awk is available, it is used, but a fallback using other common tools is also provided")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("hash")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("awk")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),t._v("/dev/null"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("IP_TO_UNREGISTER")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("ip")]),t._v(" route get "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("awk")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{print $(NF-2);exit}'")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),t._v("     "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# using awk")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("IP_TO_UNREGISTER")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("ip")]),t._v(" route get "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("cut")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" -d"),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('" "')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("head")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-1")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),t._v("        "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# simpler alternative for when awk is not available")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("fi")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-kL")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-u")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${EPORTAL_API_PASSWORD}")]),t._v('"')]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("':'")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${EPORTAL_API_PASSWORD}")]),t._v('"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-X")]),t._v(" POST "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${EPORTAL_URL}")]),t._v('"')]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/admin/api/delete_server?ip='")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${IP_TO_UNREGISTER}")]),t._v('"')]),t._v("\n")])])]),e("p",[t._v("Example (unregister_server.sh):")]),t._v(" "),e("div",{staticClass:"language-bash extra-class"},[e("pre",{pre:!0,attrs:{class:"language-bash"}},[e("code",[e("span",{pre:!0,attrs:{class:"token shebang important"}},[t._v("#!/bin/bash")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("EPORTAL_API_USERNAME")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("admin\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("EPORTAL_API_PASSWORD")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("admin\n"),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("EPORTAL_URL")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'http://192.168.246.110'")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#this is taken from the primary ip in the system. If you want to pick a different one, adjust the next line.")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("hash")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("awk")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[e("span",{pre:!0,attrs:{class:"token file-descriptor important"}},[t._v("2")]),t._v(">")]),t._v("/dev/null"),e("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("then")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("IP_TO_UNREGISTER")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("ip")]),t._v(" route get "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("awk")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'{print $(NF-2);exit}'")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),t._v("     "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# using awk")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("else")]),t._v("\n        "),e("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("IP_TO_UNREGISTER")]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),e("span",{pre:!0,attrs:{class:"token variable"}},[e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")]),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("ip")]),t._v(" route get "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("cut")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-f")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" -d"),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('" "')]),e("span",{pre:!0,attrs:{class:"token operator"}},[t._v("|")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("head")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-1")]),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("`")])]),t._v("        "),e("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# simpler alternative for when awk is not available")]),t._v("\n"),e("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("fi")]),t._v("\n\n"),e("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-kL")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-u")]),t._v(" "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${EPORTAL_API_PASSWORD}")]),t._v('"')]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("':'")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${EPORTAL_API_PASSWORD}")]),t._v('"')]),t._v(" "),e("span",{pre:!0,attrs:{class:"token parameter variable"}},[t._v("-X")]),t._v(" POST "),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${EPORTAL_URL}")]),t._v('"')]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/admin/api/delete_server?ip='")]),e("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),e("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${IP_TO_UNREGISTER}")]),t._v('"')]),t._v("\n")])])]),e("h3",{attrs:{id:"puppet-plan"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#puppet-plan"}},[t._v("#")]),t._v(" Puppet Plan")]),t._v(" "),e("p",[t._v("If you prefer to have a plan rather than a task, then you can create one from this script with the following steps:")]),t._v(" "),e("ul",[e("li",[t._v("Create a new directory called "),e("code",[t._v("eportal_puppet")])]),t._v(" "),e("li",[t._v("Inside this directory, create a bolt project:"),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("bolt project init\n")])])])]),t._v(" "),e("li",[t._v("Create a scripts directory inside it")]),t._v(" "),e("li",[t._v("Place the script above inside of it (call it "),e("code",[t._v("unregister_server.sh")]),t._v(")")]),t._v(" "),e("li",[t._v("Create the bolt plan using:"),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("bolt plan new eportal_puppet::unregister_server --script eportal_puppet/scripts/unregister_server.sh\n")])])])]),t._v(" "),e("li",[t._v("Now your plan is ready and can be called directly with:"),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("bolt plan run eportal_puppet:unregister_server -t <TARGETS>\n")])])])])]),t._v(" "),e("p",[t._v("Ad hoc run example with:")]),t._v(" "),e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[t._v("bolt plan run eportal_puppet::unregister_server -t 192.168.246.110\n")])])]),e("p",[t._v("This can be called during machine tear down to properly remove the server from ePortal.")])])},[],!1,null,null,null);s.default=r.exports}}]);